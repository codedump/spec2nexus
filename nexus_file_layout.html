<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="specplot" href="specplot.html" /><link rel="prev" title="extractSpecScan" href="extractSpecScan.html" />

    <meta name="generator" content="sphinx-4.4.0, furo 2022.03.04"/>
        <title>NeXus File Layout - spec2nexus 2021.1.11 (64.g5345aab)</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=935aa2abcc5c1da4283d1dc201fb1f0add16d23a" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=25ceb02ed1c46dc30f2321ff83e92799f69dfdb9" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">spec2nexus 2021.1.11 (64.g5345aab)</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">spec2nexus 2021.1.11 (64.g5345aab)</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="contents.html">Contents</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="spec2nexus.html">spec2nexus</a></li>
<li class="toctree-l2"><a class="reference internal" href="extractSpecScan.html">extractSpecScan</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">NeXus File Layout</a></li>
<li class="toctree-l2"><a class="reference internal" href="specplot.html">specplot</a></li>
<li class="toctree-l2"><a class="reference internal" href="specplot_gallery.html">specplot_gallery</a></li>
<li class="toctree-l2"><a class="reference internal" href="spec.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">spec2nexus.spec</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="charts.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">spec2nexus.charts</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="specplot_custom_scan_macro.html">How to write a custom scan handling for <em>specplot</em></a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="eznx.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">spec2nexus.eznx</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="writer.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">spec2nexus.writer</span></code></a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="plugin_core.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">spec2nexus.plugin</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="supplied_plugins/XPCS.html">XPCS plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="supplied_plugins/apstools_specwriter.html">apstools SpecWriterCallback metadata plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="supplied_plugins/fallback.html">Fallback plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="supplied_plugins/spec_common.html">SPEC standard plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="supplied_plugins/uim.html">UIM plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="supplied_plugins/unicat.html">unicat plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="supplied_plugins/uxml.html">#UXML: UXML metadata plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="how_to_write_plugin.html">How to write a custom plugin module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">Common Methods: <code class="xref py py-mod docutils literal notranslate"><span class="pre">spec2nexus.utils</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="scanf.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">spec2nexus.scanf</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="singletons.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">spec2nexus.singletons</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="writer.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">spec2nexus.writer</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="unit_testing.html">Unit Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="example_data.html">Example data</a></li>
<li class="toctree-l2"><a class="reference internal" href="changes.html">Change History</a></li>
<li class="toctree-l2"><a class="reference internal" href="license.html">License</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contents.html#indices-and-tables">Indices and tables</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container"><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="nexus-file-layout">
<h1>NeXus File Layout<a class="headerlink" href="#nexus-file-layout" title="Permalink to this headline">#</a></h1>
<aside class="sidebar">
<p class="sidebar-title"><em>for reference</em>: tree view</p>
<p>In this documentation, the command <a class="footnote-reference brackets" href="#punx" id="id1">2</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">punx</span> <span class="n">tree</span> <span class="n">FILENAME</span><span class="o">.</span><span class="n">hdf5</span>
</pre></div>
</div>
<p>is used to generate a tree view of an HDF5 file’s structure.</p>
</aside>
<p>SPEC data files contain data from one or more measurements called <em>scans</em>
written according to the <strong>Standard Data-File Format</strong>. <a class="footnote-reference brackets" href="#spec-format" id="id2">1</a>  Each
scan is numbered (where the number is not necessarily unique within a data
file).  NeXus files are written <a class="footnote-reference brackets" href="#id29" id="id3">3</a> as HDF5 files with a tree structure <a class="footnote-reference brackets" href="#id30" id="id4">4</a>
where the groups use the NeXus base class <a class="footnote-reference brackets" href="#id31" id="id5">5</a> definitions.</p>
<p>HDF5 files are binary (not human readable); in this documentation, the tree
structure (hierarchy) of the file will be shown.  Various terms are shown
symbolically, as described in the next table.</p>
<div class="table-wrapper"><table class="docutils align-default">
<colgroup>
<col style="width: 20%"/>
<col style="width: 17%"/>
<col style="width: 63%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>symbolic</p></th>
<th class="head"><p>example</p></th>
<th class="head"><p>meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">NAME:NXclass</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">data:NXdata</span></code></p></td>
<td><p>HDF5 name of group and NeXus base class used</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">{NAME}</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">scan_number</span></code></p></td>
<td><p>name is chosen as described</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">@{NAME}</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">@default</span></code></p></td>
<td><p>HDF5 attribute of the parent group or field <a class="footnote-reference brackets" href="#nx-field" id="id6">11</a></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">NX_{datatype}</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">NX_NUMBER</span></code></p></td>
<td><p>uses this NeXus data type <a class="footnote-reference brackets" href="#nx-datatype" id="id7">7</a></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">NX_{unittype}</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">NX_CHAR</span></code></p></td>
<td><p>uses this NeXus unit type <a class="footnote-reference brackets" href="#nx-unittype" id="id8">10</a></p></td>
</tr>
</tbody>
</table></div>
<span class="target" id="index-0"></span><section id="basic-tree-structure">
<span id="index-1"></span><h2>Basic Tree Structure<a class="headerlink" href="#basic-tree-structure" title="Permalink to this headline">#</a></h2>
<p>The basic tree structure of the NeXus HDF5 file is shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span> <span class="n">FILE_NAME</span><span class="p">:</span><span class="n">NXroot</span>
<span class="linenos">2</span>     <span class="nd">@default</span><span class="o">=</span><span class="s2">"S</span><span class="si">{SCAN_N}</span><span class="s2">"</span>
<span class="linenos">3</span>     <span class="n">S</span><span class="p">{</span><span class="n">SCAN_N</span><span class="p">}:</span><span class="n">NXentry</span>
<span class="linenos">4</span>         <span class="nd">@default</span><span class="o">=</span><span class="s2">"data"</span>
<span class="linenos">5</span>         <span class="n">data</span><span class="p">:</span><span class="n">NXdata</span>
<span class="linenos">6</span>             <span class="nd">@axes</span><span class="o">=</span><span class="p">{</span><span class="n">AXIS</span><span class="p">}</span>
<span class="linenos">7</span>             <span class="nd">@signal</span><span class="o">=</span><span class="p">{</span><span class="n">SIGNAL</span><span class="p">}</span>
<span class="linenos">8</span>             <span class="p">{</span><span class="n">AXIS</span><span class="p">}:</span><span class="n">NX_NUMBER</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span> <span class="n">data</span> <span class="o">...</span>
<span class="linenos">9</span>             <span class="p">{</span><span class="n">SIGNAL</span><span class="p">}:</span><span class="n">NX_NUMBER</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span> <span class="n">data</span> <span class="o">...</span>
</pre></div>
</div>
<aside class="sidebar">
<p class="sidebar-title"><code class="docutils literal notranslate"><span class="pre">NXroot</span></code></p>
<p>It is not required to write a <code class="docutils literal notranslate"><span class="pre">NX_class="NXroot"</span></code> attribute to the
root of any NeXus data file.  In fact, it is very rare to find this attribute
in any NeXus HDF5 file.  We only show it here for guidance in how to build
a file using the NeXus standard.</p>
</aside>
<p>The root level of the file uses the structure of the NeXus <strong>NXroot</strong> <a class="footnote-reference brackets" href="#nxroot" id="id9">21</a>
base class.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">@default</span></code> attribute points the way to the default plottable data.
See the NeXus documentation <a class="footnote-reference brackets" href="#nx-default" id="id10">12</a> for more details.</p>
<p>Here, <code class="docutils literal notranslate"><span class="pre">AXIS</span></code> and <code class="docutils literal notranslate"><span class="pre">SIGNAL</span></code> are the names of the first and last columns,
respectively, of the scan and <code class="docutils literal notranslate"><span class="pre">SCAN_N</span></code> is the scan number from the scan’s
<code class="docutils literal notranslate"><span class="pre">#S</span></code> <span class="target" id="index-2"></span>control line <a class="footnote-reference brackets" href="#spec-format" id="id11">1</a>, <a class="footnote-reference brackets" href="#control-line" id="id12">6</a> in the data file.</p>
<p>A NeXus <strong>NXentry</strong> <a class="footnote-reference brackets" href="#nxentry" id="id13">15</a> group will be created for each scan to be
written.  See section <a class="reference internal" href="#data-file-scan"><span class="std std-ref">Scan</span></a> below for more details.</p>
<aside class="sidebar">
<p class="sidebar-title">image detectors</p>
<p>SPEC data files do not usually contain data from a 2-D image
detector.  A comment (or other control line such as <code class="docutils literal notranslate"><span class="pre">#U</span></code>) may be used
to describe the location of an external file containing such data
and how to find the image frame from that file.  No standard
pattern exists for SPEC data files to reference such images.</p>
</aside>
<p>The scan data will be placed in a <strong>NXdata</strong> <a class="footnote-reference brackets" href="#nxdata" id="id14">13</a> group named <code class="docutils literal notranslate"><span class="pre">data</span></code>
below the <strong>NXentry</strong> group.   See section <a class="reference internal" href="#data-file-scan-data"><span class="std std-ref">Scan Data</span></a> below for
more details.</p>
<p>Other information from the scan will be written as described in the sections
below. There are variations on the tree structure as the complexity of a scan
increases. Examples of such variation include:</p>
<ul class="simple">
<li><p>multi-axis scans (such as <code class="docutils literal notranslate"><span class="pre">a2scan</span></code>, <code class="docutils literal notranslate"><span class="pre">a3scan</span></code>, <code class="docutils literal notranslate"><span class="pre">a4scan</span></code>)</p></li>
<li><p>multi-channel detectors</p></li>
<li><p>2-D and higher dimensionality scans (such as <code class="docutils literal notranslate"><span class="pre">mesh</span></code>, <code class="docutils literal notranslate"><span class="pre">hklmesh</span></code>, MCA)</p></li>
<li><p>custom metadata</p></li>
<li><p>comments</p></li>
</ul>
<section id="example-1-d-scan">
<h3>Example 1-D scan<a class="headerlink" href="#example-1-d-scan" title="Permalink to this headline">#</a></h3>
<p>This SPEC data file (where for brevity of this example, additional content has
been removed) is a one-dimensional step scan of a counter named <code class="docutils literal notranslate"><span class="pre">winCZT</span></code> (last
column) versus a motor named <code class="docutils literal notranslate"><span class="pre">Two</span> <span class="pre">Theta</span></code> (first column) using a counting time
of 1 second per point. Data collection was configured to include data from an
additional counter named <code class="docutils literal notranslate"><span class="pre">ic0</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">#F /home/sricat/POLAR/data/CMR/lmn40.spe</span>
<span class="linenos"> 2</span><span class="c1">#E 918630612</span>
<span class="linenos"> 3</span><span class="c1">#D Wed Feb 10 01:10:12 1999</span>
<span class="linenos"> 4</span><span class="c1">#C spec1ID  User = polar</span>
<span class="linenos"> 5</span><span class="c1">#O0    Theta  Two Theta  sample x  sample y</span>
<span class="linenos"> 6</span><span class="c1">#o0 th tth samx samy</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="c1">#S 1  ascan  tth -0.7 -0.5  101 1</span>
<span class="linenos"> 9</span><span class="c1">#D Wed Feb 10 01:11:25 1999</span>
<span class="linenos">10</span><span class="c1">#T 1  (Seconds)</span>
<span class="linenos">11</span><span class="c1">#P0 -0.80000004 -0.60000003 -0.15875 0.16375</span>
<span class="linenos">12</span><span class="c1">#N 5</span>
<span class="linenos">13</span><span class="c1">#L Two Theta    Epoch  Seconds  ic0  winCZT</span>
<span class="linenos">14</span><span class="o">-</span><span class="mf">0.70000003</span>  <span class="mi">75</span> <span class="mi">1</span> <span class="mi">340592</span> <span class="mi">1</span>
<span class="linenos">15</span><span class="o">-</span><span class="mf">0.69812503</span>  <span class="mi">76</span> <span class="mi">1</span> <span class="mi">340979</span> <span class="mi">1</span>
<span class="linenos">16</span><span class="o">-</span><span class="mf">0.69612503</span>  <span class="mi">78</span> <span class="mi">1</span> <span class="mi">341782</span> <span class="mi">1</span>
<span class="linenos">17</span><span class="o">-</span><span class="mf">0.69412503</span>  <span class="mi">79</span> <span class="mi">1</span> <span class="mi">342594</span> <span class="mi">1</span>
<span class="linenos">18</span><span class="o">-</span><span class="mf">0.69212503</span>  <span class="mi">80</span> <span class="mi">1</span> <span class="mi">343300</span> <span class="mi">0</span>
<span class="linenos">19</span><span class="o">-</span><span class="mf">0.69012503</span>  <span class="mi">82</span> <span class="mi">1</span> <span class="mi">341851</span> <span class="mi">0</span>
<span class="linenos">20</span><span class="o">-</span><span class="mf">0.68812503</span>  <span class="mi">83</span> <span class="mi">1</span> <span class="mi">342126</span> <span class="mi">1</span>
<span class="linenos">21</span><span class="o">-</span><span class="mf">0.68612503</span>  <span class="mi">85</span> <span class="mi">1</span> <span class="mi">342311</span> <span class="mi">0</span>
<span class="linenos">22</span><span class="o">-</span><span class="mf">0.68425003</span>  <span class="mi">86</span> <span class="mi">1</span> <span class="mi">343396</span> <span class="mi">1</span>
<span class="linenos">23</span><span class="o">-</span><span class="mf">0.68225003</span>  <span class="mi">88</span> <span class="mi">1</span> <span class="mi">343772</span> <span class="mi">1</span>
<span class="linenos">24</span><span class="o">-</span><span class="mf">0.68025003</span>  <span class="mi">89</span> <span class="mi">1</span> <span class="mi">343721</span> <span class="mi">1</span>
<span class="linenos">25</span><span class="o">-</span><span class="mf">0.67825003</span>  <span class="mi">91</span> <span class="mi">1</span> <span class="mi">341127</span> <span class="mi">2</span>
<span class="linenos">26</span><span class="o">-</span><span class="mf">0.67625003</span>  <span class="mi">92</span> <span class="mi">1</span> <span class="mi">343733</span> <span class="mi">0</span>
<span class="linenos">27</span><span class="c1">#C Wed Feb 10 01:12:39 1999.  More scan content removed for brevity.</span>
</pre></div>
</div>
<p>The SPEC data file is written to a NeXus HDF5 file with this tree structure (for
brevity, additional structure has been removed):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="nd">@default</span> <span class="o">=</span> <span class="s2">"S1"</span>
<span class="linenos"> 2</span><span class="n">S1</span><span class="p">:</span><span class="n">NXentry</span>
<span class="linenos"> 3</span>  <span class="nd">@default</span> <span class="o">=</span> <span class="s2">"data"</span>
<span class="linenos"> 4</span>  <span class="n">data</span><span class="p">:</span><span class="n">NXdata</span>
<span class="linenos"> 5</span>    <span class="nd">@axes</span> <span class="o">=</span> <span class="s2">"Two_Theta"</span>
<span class="linenos"> 6</span>    <span class="nd">@signal</span> <span class="o">=</span> <span class="s2">"winCZT"</span>
<span class="linenos"> 7</span>    <span class="n">Epoch</span><span class="p">:</span><span class="n">NX_FLOAT64</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">75.0</span><span class="p">,</span> <span class="mf">76.0</span><span class="p">,</span> <span class="mf">78.0</span><span class="p">,</span> <span class="s1">'...'</span><span class="p">,</span> <span class="mf">92.0</span><span class="p">]</span>
<span class="linenos"> 8</span>      <span class="nd">@spec_name</span> <span class="o">=</span> <span class="s2">"Epoch"</span>
<span class="linenos"> 9</span>    <span class="n">Seconds</span><span class="p">:</span><span class="n">NX_FLOAT64</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">'...'</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
<span class="linenos">10</span>      <span class="nd">@spec_name</span> <span class="o">=</span> <span class="s2">"Seconds"</span>
<span class="linenos">11</span>    <span class="n">Two_Theta</span><span class="p">:</span><span class="n">NX_FLOAT64</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.70000003</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.69812503</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.69612503</span><span class="p">,</span> <span class="s1">'...'</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.67625003</span><span class="p">]</span>
<span class="linenos">12</span>      <span class="nd">@spec_name</span> <span class="o">=</span> <span class="s2">"Two Theta"</span>
<span class="linenos">13</span>    <span class="n">ic0</span><span class="p">:</span><span class="n">NX_FLOAT64</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">340592.0</span><span class="p">,</span> <span class="mf">340979.0</span><span class="p">,</span> <span class="mf">341782.0</span><span class="p">,</span> <span class="s1">'...'</span><span class="p">,</span> <span class="mf">343733.0</span><span class="p">]</span>
<span class="linenos">14</span>      <span class="nd">@spec_name</span> <span class="o">=</span> <span class="s2">"ic0"</span>
<span class="linenos">15</span>    <span class="n">winCZT</span><span class="p">:</span><span class="n">NX_FLOAT64</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">'...'</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
<span class="linenos">16</span>      <span class="nd">@spec_name</span> <span class="o">=</span> <span class="s2">"winCZT"</span>
</pre></div>
</div>
</section>
</section>
<section id="spec-data-file-contents">
<h2>SPEC Data File Contents<a class="headerlink" href="#spec-data-file-contents" title="Permalink to this headline">#</a></h2>
<p>The SPEC data file is written to a NeXus HDF5 file by parts as described below.</p>
<section id="file-name">
<span id="data-file-name"></span><h3>File name<a class="headerlink" href="#file-name" title="Permalink to this headline">#</a></h3>
<p>The file name (shown in this example):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1">#F /home/sricat/POLAR/data/CMR/lmn40.spe</span>
</pre></div>
</div>
<p>The file name is copied to the file root as the <code class="docutils literal notranslate"><span class="pre">SPEC_file</span></code> attribute
(denoted here as <code class="docutils literal notranslate"><span class="pre">@SPEC_file</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="nd">@SPEC_file</span> <span class="o">=</span> <span class="s2">"/home/sricat/POLAR/data/CMR/lmn40.spe"</span>
</pre></div>
</div>
<p>It is expected there is only one <code class="docutils literal notranslate"><span class="pre">#F</span></code> control line in a SPEC data file
(assumes that the name of a file will not change midway) and, if it appears, it
is the first line.</p>
</section>
<section id="file-header">
<span id="data-file-header"></span><h3>File header<a class="headerlink" href="#file-header" title="Permalink to this headline">#</a></h3>
<p>Some content from a SPEC data file header is written to the root of the NeXus
HDF5 file.  Consider this example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1">#E 918630612</span>
<span class="linenos">2</span><span class="c1">#D Wed Feb 10 01:10:12 1999</span>
<span class="linenos">3</span><span class="c1">#C spec1ID  User = polar</span>
<span class="linenos">4</span><span class="c1">#O0    Theta  Two Theta  sample x  sample y</span>
</pre></div>
</div>
<p>From this example, this content is written to attributes of the file root:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="nd">@SPEC_epoch</span> <span class="o">=</span> <span class="mi">918630612</span>
<span class="linenos">2</span><span class="nd">@SPEC_date</span> <span class="o">=</span> <span class="s2">"1999-02-10T01:10:12"</span>
<span class="linenos">3</span><span class="nd">@SPEC_comments</span> <span class="o">=</span> <span class="s2">"spec1ID  User = polar"</span>
<span class="linenos">4</span><span class="nd">@SPEC_user</span> <span class="o">=</span> <span class="s2">"polar"</span>
<span class="linenos">5</span><span class="nd">@SPEC_num_headers</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">@SPEC_comments</span></code> attribute includes contents of <em>all</em> <code class="docutils literal notranslate"><span class="pre">#C</span></code> (comment)
lines that appear in the header section(s), joined together by newline (<code class="docutils literal notranslate"><span class="pre">\n</span></code>)
characters. See <a class="reference internal" href="#data-file-comments"><span class="std std-ref">Comments</span></a> for how this handled in scans.</p>
<p>The additional information in the positioner names <code class="docutils literal notranslate"><span class="pre">#O0</span></code> control line will be
used later (in <a class="reference internal" href="#data-file-positioners"><span class="std std-ref">Positioners</span></a>) when writing the positioners to the
file.</p>
</section>
<section id="scan">
<span id="data-file-scan"></span><h3>Scan<a class="headerlink" href="#scan" title="Permalink to this headline">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">#S</span></code> control line marks the beginning of each scan in a SPEC data file.
It provides the scan number (<code class="docutils literal notranslate"><span class="pre">SCAN_N</span></code> in SPEC) and the scan command.  Consider
this example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="c1">#S 1  ascan  tth -0.7 -0.5  101 1</span>
<span class="linenos"> 2</span><span class="c1">#D Wed Feb 10 01:11:25 1999</span>
<span class="linenos"> 3</span><span class="c1">#T 1  (Seconds)</span>
<span class="linenos"> 4</span><span class="c1">#P0 -0.80000004 -0.60000003 -0.15875 0.16375</span>
<span class="linenos"> 5</span><span class="c1">#N 5</span>
<span class="linenos"> 6</span><span class="c1">#L Two Theta    Epoch  Seconds  ic0  winCZT</span>
<span class="linenos"> 7</span><span class="o">-</span><span class="mf">0.70000003</span>  <span class="mi">75</span> <span class="mi">1</span> <span class="mi">340592</span> <span class="mi">1</span>
<span class="linenos"> 8</span><span class="o">-</span><span class="mf">0.69812503</span>  <span class="mi">76</span> <span class="mi">1</span> <span class="mi">340979</span> <span class="mi">1</span>
<span class="linenos"> 9</span><span class="o">-</span><span class="mf">0.69612503</span>  <span class="mi">78</span> <span class="mi">1</span> <span class="mi">341782</span> <span class="mi">1</span>
<span class="linenos">10</span><span class="o">-</span><span class="mf">0.69412503</span>  <span class="mi">79</span> <span class="mi">1</span> <span class="mi">342594</span> <span class="mi">1</span>
<span class="linenos">11</span><span class="o">-</span><span class="mf">0.69212503</span>  <span class="mi">80</span> <span class="mi">1</span> <span class="mi">343300</span> <span class="mi">0</span>
<span class="linenos">12</span><span class="o">-</span><span class="mf">0.69012503</span>  <span class="mi">82</span> <span class="mi">1</span> <span class="mi">341851</span> <span class="mi">0</span>
<span class="linenos">13</span><span class="o">-</span><span class="mf">0.68812503</span>  <span class="mi">83</span> <span class="mi">1</span> <span class="mi">342126</span> <span class="mi">1</span>
<span class="linenos">14</span><span class="o">-</span><span class="mf">0.68612503</span>  <span class="mi">85</span> <span class="mi">1</span> <span class="mi">342311</span> <span class="mi">0</span>
<span class="linenos">15</span><span class="o">-</span><span class="mf">0.68425003</span>  <span class="mi">86</span> <span class="mi">1</span> <span class="mi">343396</span> <span class="mi">1</span>
<span class="linenos">16</span><span class="o">-</span><span class="mf">0.68225003</span>  <span class="mi">88</span> <span class="mi">1</span> <span class="mi">343772</span> <span class="mi">1</span>
<span class="linenos">17</span><span class="o">-</span><span class="mf">0.68025003</span>  <span class="mi">89</span> <span class="mi">1</span> <span class="mi">343721</span> <span class="mi">1</span>
<span class="linenos">18</span><span class="o">-</span><span class="mf">0.67825003</span>  <span class="mi">91</span> <span class="mi">1</span> <span class="mi">341127</span> <span class="mi">2</span>
<span class="linenos">19</span><span class="o">-</span><span class="mf">0.67625003</span>  <span class="mi">92</span> <span class="mi">1</span> <span class="mi">343733</span> <span class="mi">0</span>
<span class="linenos">20</span><span class="c1">#C Wed Feb 10 01:12:39 1999.  More scan content removed for brevity.</span>
</pre></div>
</div>
<p>From this example, this structure (from <code class="docutils literal notranslate"><span class="pre">#S</span></code>, <code class="docutils literal notranslate"><span class="pre">#D</span></code>, <code class="docutils literal notranslate"><span class="pre">#T</span></code>, and <code class="docutils literal notranslate"><span class="pre">#C</span></code>
control lines) is written as a new <strong>NXentry</strong> [#NXentry] group at the root of
the NeXus HDF5 file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="n">S1</span><span class="p">:</span><span class="n">NXentry</span>
<span class="linenos"> 2</span>  <span class="nd">@NX_class</span> <span class="o">=</span> <span class="s2">"NXentry"</span>
<span class="linenos"> 3</span>  <span class="nd">@default</span> <span class="o">=</span> <span class="s2">"data"</span>
<span class="linenos"> 4</span>  <span class="n">T</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="linenos"> 5</span>    <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"SPEC scan with constant counting time"</span>
<span class="linenos"> 6</span>    <span class="nd">@units</span> <span class="o">=</span> <span class="s2">"s"</span>
<span class="linenos"> 7</span>  <span class="n">command</span><span class="p">:</span><span class="n">NX_CHAR</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">'ascan  tth -0.7 -0.5  101 1'</span><span class="p">]</span>
<span class="linenos"> 8</span>  <span class="n">comments</span><span class="p">:</span><span class="n">NX_CHAR</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">'Wed Feb 10 01:12:39 1999.  More scan content removed for brevity.'</span><span class="p">]</span>
<span class="linenos"> 9</span>  <span class="n">counting_basis</span><span class="p">:</span><span class="n">NX_CHAR</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">'SPEC scan with constant counting time'</span><span class="p">]</span>
<span class="linenos">10</span>  <span class="n">date</span><span class="p">:</span><span class="n">NX_CHAR</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">'1999-02-10T01:11:25'</span><span class="p">]</span>
<span class="linenos">11</span>  <span class="n">experiment_description</span><span class="p">:</span><span class="n">NX_CHAR</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">'SPEC scan'</span><span class="p">]</span>
<span class="linenos">12</span>    <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"SPEC data file scan"</span>
<span class="linenos">13</span>  <span class="n">scan_number</span><span class="p">:</span><span class="n">NX_INT64</span> <span class="o">=</span> <span class="mi">1</span>
<span class="linenos">14</span>    <span class="nd">@spec_name</span> <span class="o">=</span> <span class="s2">"SCAN_N"</span>
<span class="linenos">15</span>  <span class="n">title</span><span class="p">:</span><span class="n">NX_CHAR</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">'1  ascan  tth -0.7 -0.5  101 1'</span><span class="p">]</span>
</pre></div>
</div>
<p>The name of the group is composed from the scan number (<code class="docutils literal notranslate"><span class="pre">SCAN_N</span></code>) as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">S</span><span class="p">{</span><span class="n">SCAN_N</span><span class="p">}</span>
</pre></div>
</div>
<p>(such as <code class="docutils literal notranslate"><span class="pre">S1</span></code> for <code class="docutils literal notranslate"><span class="pre">SCAN_N=1</span></code>).</p>
<p>If there is more than one scan with the same <code class="docutils literal notranslate"><span class="pre">SCAN_N</span></code> (such as <code class="docutils literal notranslate"><span class="pre">#S</span> <span class="pre">1</span></code>) in
the data file, the <em>additional scans</em> will be named with an additional decimal
point and then a sequence number (described here as <code class="docutils literal notranslate"><span class="pre">REPEAT_NUMBER</span></code>)
indicating the specific repeat:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">S</span><span class="p">{</span><span class="n">SCAN_N</span><span class="p">}</span><span class="o">.</span><span class="p">{</span><span class="n">REPEAT_NUMBER</span><span class="p">}</span>
</pre></div>
</div>
<p>(such as <code class="docutils literal notranslate"><span class="pre">S1</span></code>, <code class="docutils literal notranslate"><span class="pre">S1.1</span></code> and <code class="docutils literal notranslate"><span class="pre">S1.2</span></code> for the first, second, and third scans,
respectively, with <code class="docutils literal notranslate"><span class="pre">#S</span> <span class="pre">1</span></code>) The <a class="reference internal" href="#data-file-scan-data"><span class="std std-ref">Scan Data</span></a> will be described in
the next section.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">command</span></code> and <code class="docutils literal notranslate"><span class="pre">title</span></code> are almost* the same content but not exactly
the same.  The difference is that <code class="docutils literal notranslate"><span class="pre">command</span></code> is the <code class="docutils literal notranslate"><span class="pre">title</span></code> with the scan
number removed from the beginning.</p>
<p>If the scan had been against a constant monitor count (nstead of a fixed time
interval), then the <code class="docutils literal notranslate"><span class="pre">#T</span></code> line in the scan is replaced by <code class="docutils literal notranslate"><span class="pre">#M</span></code> line, such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1">#M 20000  (I0)</span>
</pre></div>
</div>
<p>In the NeXus HDF5 file, the <code class="docutils literal notranslate"><span class="pre">T</span></code> field is replaced by <code class="docutils literal notranslate"><span class="pre">M</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">M</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">20000.0</span>
<span class="linenos">2</span>   <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"SPEC scan with constant monitor count"</span>
<span class="linenos">3</span>   <span class="nd">@units</span> <span class="o">=</span> <span class="s2">"counts"</span>
</pre></div>
</div>
<p>FIXME: What? No <strong>NXmonitor</strong> <a class="footnote-reference brackets" href="#nxmonitor" id="id15">17</a> group?  Link value to M or T field.</p>
</section>
<section id="scan-data">
<span id="data-file-scan-data"></span><h3>Scan Data<a class="headerlink" href="#scan-data" title="Permalink to this headline">#</a></h3>
<p>Consider the SPEC scan data shown in section <a class="reference internal" href="#data-file-scan"><span class="std std-ref">Scan</span></a> above.  The
<code class="docutils literal notranslate"><span class="pre">#L</span></code>, <code class="docutils literal notranslate"><span class="pre">#N</span></code>, <code class="docutils literal notranslate"><span class="pre">#M</span></code>, <code class="docutils literal notranslate"><span class="pre">#T</span></code>, and data lines (those with no <code class="docutils literal notranslate"><span class="pre">#</span></code> at the start
of the line) are written as a new <strong>NXdata</strong> <a class="footnote-reference brackets" href="#nxdata" id="id16">13</a> group as a child of the scan
group (<strong>NXentry</strong>) of the NeXus HDF5 file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="n">data</span><span class="p">:</span><span class="n">NXdata</span>
<span class="linenos"> 2</span>  <span class="nd">@NX_class</span> <span class="o">=</span> <span class="s2">"NXdata"</span>
<span class="linenos"> 3</span>  <span class="nd">@Two_Theta_indices</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="linenos"> 4</span>  <span class="nd">@axes</span> <span class="o">=</span> <span class="s2">"Two_Theta"</span>
<span class="linenos"> 5</span>  <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"SPEC scan data"</span>
<span class="linenos"> 6</span>  <span class="nd">@signal</span> <span class="o">=</span> <span class="s2">"winCZT"</span>
<span class="linenos"> 7</span>  <span class="n">Epoch</span><span class="p">:</span><span class="n">NX_FLOAT64</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">75.0</span><span class="p">,</span> <span class="mf">76.0</span><span class="p">,</span> <span class="mf">78.0</span><span class="p">,</span> <span class="s1">'...'</span><span class="p">,</span> <span class="mf">92.0</span><span class="p">]</span>
<span class="linenos"> 8</span>    <span class="nd">@spec_name</span> <span class="o">=</span> <span class="s2">"Epoch"</span>
<span class="linenos"> 9</span>  <span class="n">Seconds</span><span class="p">:</span><span class="n">NX_FLOAT64</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">'...'</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
<span class="linenos">10</span>    <span class="nd">@spec_name</span> <span class="o">=</span> <span class="s2">"Seconds"</span>
<span class="linenos">11</span>  <span class="n">Two_Theta</span><span class="p">:</span><span class="n">NX_FLOAT64</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.70000003</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.69812503</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.69612503</span><span class="p">,</span> <span class="s1">'...'</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.67625003</span><span class="p">]</span>
<span class="linenos">12</span>    <span class="nd">@spec_name</span> <span class="o">=</span> <span class="s2">"Two Theta"</span>
<span class="linenos">13</span>  <span class="n">ic0</span><span class="p">:</span><span class="n">NX_FLOAT64</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">340592.0</span><span class="p">,</span> <span class="mf">340979.0</span><span class="p">,</span> <span class="mf">341782.0</span><span class="p">,</span> <span class="s1">'...'</span><span class="p">,</span> <span class="mf">343733.0</span><span class="p">]</span>
<span class="linenos">14</span>    <span class="nd">@spec_name</span> <span class="o">=</span> <span class="s2">"ic0"</span>
<span class="linenos">15</span>  <span class="n">winCZT</span><span class="p">:</span><span class="n">NX_FLOAT64</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">'...'</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
<span class="linenos">16</span>    <span class="nd">@spec_name</span> <span class="o">=</span> <span class="s2">"winCZT"</span>
</pre></div>
</div>
</section>
<section id="positioners">
<span id="data-file-positioners"></span><h3>Positioners<a class="headerlink" href="#positioners" title="Permalink to this headline">#</a></h3>
<p>Consider the SPEC scan data shown in section <a class="reference internal" href="#data-file-scan"><span class="std std-ref">Scan</span></a> above,
associated with the scan header data shown in section <a class="reference internal" href="#data-file-header"><span class="std std-ref">File header</span></a>.
The <code class="docutils literal notranslate"><span class="pre">#O</span></code> lines in the header provide the <em>names</em> of the positioners while the
<code class="docutils literal notranslate"><span class="pre">#P</span></code> lines report the positioner values at the start of the scan. The lines
are numbered with a sequential index (starting at <code class="docutils literal notranslate"><span class="pre">0</span></code>) to keep the line
lengths within page limits. When present (such as this example), the <code class="docutils literal notranslate"><span class="pre">#o</span></code>
lines provide the <em>mnemonic</em> (also known as <em>mne</em>) names corresponding to the
positioner names from the <code class="docutils literal notranslate"><span class="pre">#O</span></code> lines.</p>
<p>The data from the <code class="docutils literal notranslate"><span class="pre">#O</span></code> and <code class="docutils literal notranslate"><span class="pre">#P</span></code> lines is written to a <strong>NXnote</strong>
<a class="footnote-reference brackets" href="#nxnote" id="id17">19</a> group named <code class="docutils literal notranslate"><span class="pre">positioners</span></code>.
The <code class="docutils literal notranslate"><span class="pre">positioners</span></code> group is written as a child of the scan group (<strong>NXentry</strong>)
of the NeXus HDF5 file.
This group is also linked to the <code class="docutils literal notranslate"><span class="pre">instrument</span></code> group. <a class="footnote-reference brackets" href="#nxinstrument" id="id18">16</a> See the
<a class="reference internal" href="#data-file-instrument"><span class="std std-ref">Instrument</span></a> section below.</p>
<p>Each positioner (name and value) is written to a <strong>NXpositioner</strong>
<a class="footnote-reference brackets" href="#nxpositioner" id="id19">20</a> group with a name derived (via
<a class="reference internal" href="utils.html#spec2nexus.utils.clean_name" title="spec2nexus.utils.clean_name"><code class="xref py py-func docutils literal notranslate"><span class="pre">clean_name()</span></code></a>) from the name provided in the SPEC scan.
_This change of names ensures the field names in the NeXus HDF5 file conform to
the NeXus standard. [#NX.naming.datarules]  If the SPEC menmonic is available in
the data file, it is also written as a <code class="docutils literal notranslate"><span class="pre">@spec_mne</span></code> attribute with both the
<code class="docutils literal notranslate"><span class="pre">name</span></code> and <code class="docutils literal notranslate"><span class="pre">value</span></code> fields. The <strong>NXpositioner</strong> groups are written as
children of the <code class="docutils literal notranslate"><span class="pre">positioners</span></code> group.</p>
<div class="admonition note" id="index-3">
<p class="admonition-title">Note</p>
<p>Engineering units are not written</p>
<p>No <code class="docutils literal notranslate"><span class="pre">@units</span></code> attribute is provided for any of the values written by
<strong>spec2nexus</strong> (except where provided by custom support). SPEC data files do
not provide the engineering units for any of the values and it is not
possible to guess the appropriate type of units <a class="footnote-reference brackets" href="#nx-unittype" id="id20">10</a> to use. The
NeXus documentation about data units <a class="footnote-reference brackets" href="#nx-units-datarules" id="id21">8</a> states:</p>
<blockquote>
<div><p>… any field must have a units attribute which describes the units.</p>
</div></blockquote>
<p>yet this is not a strict requirement.  (The <code class="docutils literal notranslate"><span class="pre">@units</span></code> attribute is not marked
required in the NeXus NXDL schema.)</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="n">positioners</span><span class="p">:</span><span class="n">NXnote</span>
<span class="linenos"> 2</span>   <span class="nd">@NX_class</span> <span class="o">=</span> <span class="s2">"NXnote"</span>
<span class="linenos"> 3</span>   <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"SPEC positioners (#P &amp; #O lines)"</span>
<span class="linenos"> 4</span>   <span class="nd">@target</span> <span class="o">=</span> <span class="s2">"/S1/positioners"</span>
<span class="linenos"> 5</span>   <span class="n">Theta</span><span class="p">:</span><span class="n">NXpositioner</span>
<span class="linenos"> 6</span>     <span class="nd">@NX_class</span> <span class="o">=</span> <span class="s2">"NXpositioner"</span>
<span class="linenos"> 7</span>     <span class="n">name</span><span class="p">:</span><span class="n">NX_CHAR</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">'Theta'</span><span class="p">]</span>
<span class="linenos"> 8</span>       <span class="nd">@spec_mne</span> <span class="o">=</span> <span class="s2">"th"</span>
<span class="linenos"> 9</span>       <span class="nd">@spec_name</span> <span class="o">=</span> <span class="s2">"Theta"</span>
<span class="linenos">10</span>     <span class="n">value</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.80000004</span>
<span class="linenos">11</span>       <span class="nd">@spec_mne</span> <span class="o">=</span> <span class="s2">"th"</span>
<span class="linenos">12</span>       <span class="nd">@spec_name</span> <span class="o">=</span> <span class="s2">"Theta"</span>
<span class="linenos">13</span>   <span class="n">Two_Theta</span><span class="p">:</span><span class="n">NXpositioner</span>
<span class="linenos">14</span>     <span class="nd">@NX_class</span> <span class="o">=</span> <span class="s2">"NXpositioner"</span>
<span class="linenos">15</span>     <span class="n">name</span><span class="p">:</span><span class="n">NX_CHAR</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">'Two_Theta'</span><span class="p">]</span>
<span class="linenos">16</span>       <span class="nd">@spec_mne</span> <span class="o">=</span> <span class="s2">"tth"</span>
<span class="linenos">17</span>       <span class="nd">@spec_name</span> <span class="o">=</span> <span class="s2">"Two Theta"</span>
<span class="linenos">18</span>     <span class="n">value</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.60000003</span>
<span class="linenos">19</span>       <span class="nd">@spec_mne</span> <span class="o">=</span> <span class="s2">"tth"</span>
<span class="linenos">20</span>       <span class="nd">@spec_name</span> <span class="o">=</span> <span class="s2">"Two Theta"</span>
<span class="linenos">21</span>   <span class="n">sample_x</span><span class="p">:</span><span class="n">NXpositioner</span>
<span class="linenos">22</span>     <span class="nd">@NX_class</span> <span class="o">=</span> <span class="s2">"NXpositioner"</span>
<span class="linenos">23</span>     <span class="n">name</span><span class="p">:</span><span class="n">NX_CHAR</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">'sample_x'</span><span class="p">]</span>
<span class="linenos">24</span>       <span class="nd">@spec_mne</span> <span class="o">=</span> <span class="s2">"samx"</span>
<span class="linenos">25</span>       <span class="nd">@spec_name</span> <span class="o">=</span> <span class="s2">"sample x"</span>
<span class="linenos">26</span>     <span class="n">value</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.15875</span>
<span class="linenos">27</span>       <span class="nd">@spec_mne</span> <span class="o">=</span> <span class="s2">"samx"</span>
<span class="linenos">28</span>       <span class="nd">@spec_name</span> <span class="o">=</span> <span class="s2">"sample x"</span>
<span class="linenos">29</span>   <span class="n">sample_y</span><span class="p">:</span><span class="n">NXpositioner</span>
<span class="linenos">30</span>     <span class="nd">@NX_class</span> <span class="o">=</span> <span class="s2">"NXpositioner"</span>
<span class="linenos">31</span>     <span class="n">name</span><span class="p">:</span><span class="n">NX_CHAR</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">'sample_y'</span><span class="p">]</span>
<span class="linenos">32</span>       <span class="nd">@spec_mne</span> <span class="o">=</span> <span class="s2">"samy"</span>
<span class="linenos">33</span>       <span class="nd">@spec_name</span> <span class="o">=</span> <span class="s2">"sample y"</span>
<span class="linenos">34</span>     <span class="n">value</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.16375</span>
<span class="linenos">35</span>       <span class="nd">@spec_mne</span> <span class="o">=</span> <span class="s2">"samy"</span>
<span class="linenos">36</span>       <span class="nd">@spec_name</span> <span class="o">=</span> <span class="s2">"sample y"</span>
</pre></div>
</div>
<p>When the <code class="docutils literal notranslate"><span class="pre">#o</span></code> lines are present in the scan’s header, a <strong>NXnote</strong> <a class="footnote-reference brackets" href="#nxnote" id="id22">19</a>
group named <code class="docutils literal notranslate"><span class="pre">positioner_cross_reference</span></code> is written as a child of the scan
group (<strong>NXentry</strong>) of the NeXus HDF5 file.  This group describes a
cross-reference between the <em>field</em> names of the <code class="docutils literal notranslate"><span class="pre">positioner</span></code> group and the
positioner names used in the SPEC scan.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="n">positioner_cross_reference</span><span class="p">:</span><span class="n">NXnote</span>
<span class="linenos"> 2</span>   <span class="nd">@NX_class</span> <span class="o">=</span> <span class="s2">"NXnote"</span>
<span class="linenos"> 3</span>   <span class="nd">@comment</span> <span class="o">=</span> <span class="s2">"keys are SPEC positioner mnemonics, values are SPEC positioner names"</span>
<span class="linenos"> 4</span>   <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"cross-reference SPEC positioner mnemonics and names"</span>
<span class="linenos"> 5</span>   <span class="n">samx</span><span class="p">:</span><span class="n">NX_CHAR</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">'sample x'</span><span class="p">]</span>
<span class="linenos"> 6</span>     <span class="nd">@field_name</span> <span class="o">=</span> <span class="s2">"sample_x"</span>
<span class="linenos"> 7</span>     <span class="nd">@mne</span> <span class="o">=</span> <span class="s2">"samx"</span>
<span class="linenos"> 8</span>   <span class="n">samy</span><span class="p">:</span><span class="n">NX_CHAR</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">'sample y'</span><span class="p">]</span>
<span class="linenos"> 9</span>     <span class="nd">@field_name</span> <span class="o">=</span> <span class="s2">"sample_y"</span>
<span class="linenos">10</span>     <span class="nd">@mne</span> <span class="o">=</span> <span class="s2">"samy"</span>
<span class="linenos">11</span>   <span class="n">th</span><span class="p">:</span><span class="n">NX_CHAR</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">'Theta'</span><span class="p">]</span>
<span class="linenos">12</span>     <span class="nd">@field_name</span> <span class="o">=</span> <span class="s2">"Theta"</span>
<span class="linenos">13</span>     <span class="nd">@mne</span> <span class="o">=</span> <span class="s2">"th"</span>
<span class="linenos">14</span>   <span class="n">tth</span><span class="p">:</span><span class="n">NX_CHAR</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">'Two Theta'</span><span class="p">]</span>
<span class="linenos">15</span>     <span class="nd">@field_name</span> <span class="o">=</span> <span class="s2">"Two_Theta"</span>
<span class="linenos">16</span>     <span class="nd">@mne</span> <span class="o">=</span> <span class="s2">"tth"</span>
</pre></div>
</div>
</section>
<section id="counters">
<span id="data-file-counters"></span><h3>Counters<a class="headerlink" href="#counters" title="Permalink to this headline">#</a></h3>
<p>SPEC data file header control lines <code class="docutils literal notranslate"><span class="pre">#J</span></code> and <code class="docutils literal notranslate"><span class="pre">#j</span></code> describe the relationship
between counter names (<code class="docutils literal notranslate"><span class="pre">#J</span></code>) and mnemonics (<code class="docutils literal notranslate"><span class="pre">#j</span></code>).  The lines
are numbered with a sequential index (starting at <code class="docutils literal notranslate"><span class="pre">0</span></code>) to keep the line
lengths within page limits.</p>
<p>When both types are present in the scan’s header, such as this example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1">#J0 seconds  I0  I00  USAXS_PD  TR_diode</span>
<span class="linenos">2</span><span class="c1">#j0 sec I0 I00 upd2 trd</span>
</pre></div>
</div>
<p>then a <strong>NXnote</strong> <a class="footnote-reference brackets" href="#nxnote" id="id23">19</a> group named <code class="docutils literal notranslate"><span class="pre">counter_cross_reference</span></code> is written
as a child of the scan group (<strong>NXentry</strong>) of the NeXus HDF5 file.  The fields
of the group are the mnemonics and the values are the names.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">counter_cross_reference</span><span class="p">:</span><span class="n">NXnote</span>
<span class="linenos">2</span>   <span class="nd">@NX_class</span> <span class="o">=</span> <span class="s2">"NXnote"</span>
<span class="linenos">3</span>   <span class="nd">@comment</span> <span class="o">=</span> <span class="s2">"keys are SPEC counter mnemonics, values are SPEC counter names"</span>
<span class="linenos">4</span>   <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"cross-reference SPEC counter mnemonics and names"</span>
<span class="linenos">5</span>   <span class="n">I0</span><span class="p">:</span><span class="n">NX_CHAR</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">'I0'</span><span class="p">]</span>
<span class="linenos">6</span>   <span class="n">I00</span><span class="p">:</span><span class="n">NX_CHAR</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">'I00'</span><span class="p">]</span>
<span class="linenos">7</span>   <span class="n">sec</span><span class="p">:</span><span class="n">NX_CHAR</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">'seconds'</span><span class="p">]</span>
<span class="linenos">8</span>   <span class="n">trd</span><span class="p">:</span><span class="n">NX_CHAR</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">'TR_diode'</span><span class="p">]</span>
<span class="linenos">9</span>   <span class="n">upd2</span><span class="p">:</span><span class="n">NX_CHAR</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">'USAXS_PD'</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="geometry">
<span id="data-file-geometry"></span><h3>Geometry<a class="headerlink" href="#geometry" title="Permalink to this headline">#</a></h3>
<p>FIXME:  finish this section</p>
<p>Diffractometer Configuration and sample orientation</p>
<p>When a diffractometer geometry is used, any of the control lines in the next table
may be present in a scan.</p>
<div class="table-wrapper"><table class="docutils align-default">
<colgroup>
<col style="width: 21%"/>
<col style="width: 15%"/>
<col style="width: 64%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>control line</p></th>
<th class="head"><p>array</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">#G0</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">G[]</span></code></p></td>
<td><p>geo mode, sector, etc</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">#G1</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">U[]</span></code></p></td>
<td><p>lattice constants, orientation reflections</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">#G2</span></code></p></td>
<td></td>
<td><p>unused</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">#G3</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">UB[]</span></code></p></td>
<td><p>orientation matrix</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">#G4</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Q[]</span></code></p></td>
<td><p>lambda, frozen angles, cut points, etc</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">#Q</span></code></p></td>
<td></td>
<td><p><em>hkl</em> values at start of scan</p></td>
</tr>
</tbody>
</table></div>
<p>Very compact format</p>
<p>Content of some lines depends on diffractometer geometry in use but that
geometry is not reported in the data file.</p>
<p>Can report <code class="docutils literal notranslate"><span class="pre">@units</span></code> since it is known that motors are angles in degrees and lengths
are in angstrom.</p>
<p>information in <a class="reference external" href="https://github.com/prjemian/spec2nexus/blob/main/src/spec2nexus/diffractometer-geometries.dict">https://github.com/prjemian/spec2nexus/blob/main/src/spec2nexus/diffractometer-geometries.dict</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1">#G0 0 0 1 0 0 1 0 0 0 0 0 0 50 0 0.1 0 68 68 50 -1 1 1 3.13542 3.13542 0 463.6 838.8</span>
<span class="linenos">2</span><span class="c1">#G1 5.139 5.139 5.139 90 90 90 1.222647462 1.222647462 1.222647462 90 90 90 2 2 0 0 0 2 60 30 90 0 0 0 60 30 0 0 0 0 0.8265814273 0.8265814273</span>
<span class="linenos">3</span><span class="c1">#G3 -7.940607166e-18 1.138130079e-16 1.222647462 0.8645423114 -0.8645423114 0 0.8645423114 0.8645423114 -2.668317968e-16</span>
<span class="linenos">4</span><span class="c1">#G4 3.986173683 4.00012985 0 0.8265814273 0 0 0 90 0.15 0 0 0 86 0 0 0 -180 -180 -180 -180 -180 -180 -180 -180 -180 0</span>
<span class="linenos">5</span><span class="c1">#Q 3.98617 4.00013 0</span>
</pre></div>
</div>
<p>It is possible to infer the diffractometer geometry in many cases by content in
the <code class="docutils literal notranslate"><span class="pre">#G0</span></code> and <code class="docutils literal notranslate"><span class="pre">#G4</span></code> control lines, which includes the number and names of
the motors in the geometry. With the control lines above and these motor names
as shown below, the geometry is inferred as <strong>fourc</strong>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1">#O0  2-theta     theta       chi       phi   antheta  an2theta    z-axis     m_1_8</span>
</pre></div>
</div>
<p>The <em>hkl</em> values at the start of the scan are written to the scan group in the
NeXus HDF5 file as shown here:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">Q</span><span class="p">:</span><span class="n">NX_FLOAT64</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">3.98617</span><span class="p">,</span> <span class="mf">4.00013</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
<span class="linenos">2</span>   <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"hkl at start of scan"</span>
</pre></div>
</div>
<p>The uninterpreted information from the <code class="docutils literal notranslate"><span class="pre">#G</span></code> control lines is written to
the scan group in the NeXus HDF5 file as shown here:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="n">G</span><span class="p">:</span><span class="n">NXnote</span>
<span class="linenos"> 2</span>   <span class="nd">@NX_class</span> <span class="o">=</span> <span class="s2">"NXnote"</span>
<span class="linenos"> 3</span>   <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"SPEC geometry arrays, meanings defined by SPEC diffractometer support"</span>
<span class="linenos"> 4</span>   <span class="n">G0</span><span class="p">:</span><span class="n">NX_FLOAT64</span><span class="p">[</span><span class="mi">27</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">'...'</span><span class="p">,</span> <span class="mf">838.8</span><span class="p">]</span>
<span class="linenos"> 5</span>     <span class="nd">@spec_name</span> <span class="o">=</span> <span class="s2">"G0"</span>
<span class="linenos"> 6</span>   <span class="n">G1</span><span class="p">:</span><span class="n">NX_FLOAT64</span><span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5.139</span><span class="p">,</span> <span class="mf">5.139</span><span class="p">,</span> <span class="mf">5.139</span><span class="p">,</span> <span class="s1">'...'</span><span class="p">,</span> <span class="mf">0.8265814273</span><span class="p">]</span>
<span class="linenos"> 7</span>     <span class="nd">@spec_name</span> <span class="o">=</span> <span class="s2">"G1"</span>
<span class="linenos"> 8</span>   <span class="n">G3</span><span class="p">:</span><span class="n">NX_FLOAT64</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">7.940607166e-18</span><span class="p">,</span> <span class="mf">1.138130079e-16</span><span class="p">,</span> <span class="mf">1.222647462</span><span class="p">,</span> <span class="s1">'...'</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.668317968e-16</span><span class="p">]</span>
<span class="linenos"> 9</span>     <span class="nd">@spec_name</span> <span class="o">=</span> <span class="s2">"G3"</span>
<span class="linenos">10</span>   <span class="n">G4</span><span class="p">:</span><span class="n">NX_FLOAT64</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">3.986173683</span><span class="p">,</span> <span class="mf">4.00012985</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">'...'</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
<span class="linenos">11</span>     <span class="nd">@spec_name</span> <span class="o">=</span> <span class="s2">"G4"</span>
</pre></div>
</div>
<p>The interpreted information from the <code class="docutils literal notranslate"><span class="pre">G[]</span></code> array is written to the
<code class="docutils literal notranslate"><span class="pre">geometry_parameters</span></code> group (<strong>NXnote</strong> <a class="footnote-reference brackets" href="#nxnote" id="id24">19</a>), a child of the
<code class="docutils literal notranslate"><span class="pre">instrument</span></code> group (see section <a class="reference internal" href="#data-file-geometry"><span class="std std-ref">Geometry</span></a>).  Text description
of each parameter is provided when available.</p>
<p>If it was possible to determine the name of the diffractometer geometry, that
name will be reported in the <code class="docutils literal notranslate"><span class="pre">name</span></code> field.  In SPEC, some of the geometries
have variants.  The variant is appended to the name as:
<code class="docutils literal notranslate"><span class="pre">{GEOMETRY}.{VARIANT}</span></code>.  In the example below, the name is <code class="docutils literal notranslate"><span class="pre">fourc.default</span></code>.</p>
<p>If the wavelength of the scan is available in the <code class="docutils literal notranslate"><span class="pre">#G</span></code> lines, it is written to
a <strong>NXmonochromator</strong> [#NXmonochromator] group as a child of the <code class="docutils literal notranslate"><span class="pre">instrument</span></code>
group.</p>
<p>Consult the SPEC documentation (<a class="reference external" href="https://certif.com">https://certif.com</a>) or macros for further
descrption of any of the geometry information.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="n">instrument</span><span class="p">:</span><span class="n">NXinstrument</span>
<span class="linenos">  2</span>   <span class="nd">@NX_class</span> <span class="o">=</span> <span class="s2">"NXinstrument"</span>
<span class="linenos">  3</span>   <span class="n">name</span><span class="p">:</span><span class="n">NX_CHAR</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">'fourc.default'</span><span class="p">]</span>
<span class="linenos">  4</span>   <span class="n">positioners</span> <span class="o">--&gt;</span> <span class="o">/</span><span class="n">S1</span><span class="o">/</span><span class="n">positioners</span>
<span class="linenos">  5</span>   <span class="n">geometry_parameters</span><span class="p">:</span><span class="n">NXnote</span>
<span class="linenos">  6</span>     <span class="nd">@NX_class</span> <span class="o">=</span> <span class="s2">"NXnote"</span>
<span class="linenos">  7</span>     <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"SPEC geometry arrays, interpreted"</span>
<span class="linenos">  8</span>     <span class="n">ALPHA</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos">  9</span>     <span class="n">AZIMUTH</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">90.0</span>
<span class="linenos"> 10</span>     <span class="n">BETA</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos"> 11</span>     <span class="n">CUT_AZI</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos"> 12</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"azimuthal cut-point flag"</span>
<span class="linenos"> 13</span>     <span class="n">CUT_CHI</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="o">-</span><span class="mf">180.0</span>
<span class="linenos"> 14</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"chi cut point"</span>
<span class="linenos"> 15</span>     <span class="n">CUT_CHIR</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="o">-</span><span class="mf">180.0</span>
<span class="linenos"> 16</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"chiR cut point"</span>
<span class="linenos"> 17</span>     <span class="n">CUT_KAP</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="o">-</span><span class="mf">180.0</span>
<span class="linenos"> 18</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"kap cut point"</span>
<span class="linenos"> 19</span>     <span class="n">CUT_KPHI</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="o">-</span><span class="mf">180.0</span>
<span class="linenos"> 20</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"phi cut point"</span>
<span class="linenos"> 21</span>     <span class="n">CUT_KTH</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="o">-</span><span class="mf">180.0</span>
<span class="linenos"> 22</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"theta cut point"</span>
<span class="linenos"> 23</span>     <span class="n">CUT_PHI</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="o">-</span><span class="mf">180.0</span>
<span class="linenos"> 24</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"phi cut point"</span>
<span class="linenos"> 25</span>     <span class="n">CUT_PHIR</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="o">-</span><span class="mf">180.0</span>
<span class="linenos"> 26</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"phiR cut point"</span>
<span class="linenos"> 27</span>     <span class="n">CUT_TH</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="o">-</span><span class="mf">180.0</span>
<span class="linenos"> 28</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"theta/omega cut point"</span>
<span class="linenos"> 29</span>     <span class="n">CUT_TTH</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="o">-</span><span class="mf">180.0</span>
<span class="linenos"> 30</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"two-theta cut point"</span>
<span class="linenos"> 31</span>     <span class="n">F_ALPHA</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.15</span>
<span class="linenos"> 32</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"Frozen values"</span>
<span class="linenos"> 33</span>     <span class="n">F_AZIMUTH</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos"> 34</span>     <span class="n">F_BETA</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos"> 35</span>     <span class="n">F_CHI_Z</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos"> 36</span>     <span class="n">F_OMEGA</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos"> 37</span>     <span class="n">F_PHI</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">86.0</span>
<span class="linenos"> 38</span>     <span class="n">F_PHI_Z</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos"> 39</span>     <span class="n">F_THETA</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos"> 40</span>     <span class="n">H</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">3.986173683</span>
<span class="linenos"> 41</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"1st Miller index"</span>
<span class="linenos"> 42</span>     <span class="n">K</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">4.00012985</span>
<span class="linenos"> 43</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"2nd Miller index"</span>
<span class="linenos"> 44</span>     <span class="n">L</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos"> 45</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"3rd Miller index"</span>
<span class="linenos"> 46</span>     <span class="n">LAMBDA</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.8265814273</span>
<span class="linenos"> 47</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"wavelength, Angstrom"</span>
<span class="linenos"> 48</span>     <span class="n">OMEGA</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos"> 49</span>     <span class="n">diffractometer_full</span><span class="p">:</span><span class="n">NX_CHAR</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">'fourc.default'</span><span class="p">]</span>
<span class="linenos"> 50</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"name of diffractometer (and variant), deduced from scan information"</span>
<span class="linenos"> 51</span>     <span class="n">diffractometer_simple</span><span class="p">:</span><span class="n">NX_CHAR</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">'fourc'</span><span class="p">]</span>
<span class="linenos"> 52</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"name of diffractometer, deduced from scan information"</span>
<span class="linenos"> 53</span>     <span class="n">diffractometer_variant</span><span class="p">:</span><span class="n">NX_CHAR</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">'default'</span><span class="p">]</span>
<span class="linenos"> 54</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"name of diffractometer variant, deduced from scan information"</span>
<span class="linenos"> 55</span>     <span class="n">g_aa</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">5.139</span>
<span class="linenos"> 56</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"a lattice constant (real space)"</span>
<span class="linenos"> 57</span>     <span class="n">g_aa_s</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">1.222647462</span>
<span class="linenos"> 58</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"a lattice constant (reciprocal space)"</span>
<span class="linenos"> 59</span>     <span class="n">g_al</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">90.0</span>
<span class="linenos"> 60</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"alpha lattice angle (real space)"</span>
<span class="linenos"> 61</span>     <span class="n">g_al_s</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">90.0</span>
<span class="linenos"> 62</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"alpha lattice angle (reciprocal space)"</span>
<span class="linenos"> 63</span>     <span class="n">g_ana_d</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">3.13542</span>
<span class="linenos"> 64</span>     <span class="n">g_ana_det_len</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">50.0</span>
<span class="linenos"> 65</span>     <span class="n">g_ana_sign</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="linenos"> 66</span>     <span class="n">g_bb</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">5.139</span>
<span class="linenos"> 67</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"b lattice constant (real space)"</span>
<span class="linenos"> 68</span>     <span class="n">g_bb_s</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">1.222647462</span>
<span class="linenos"> 69</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"b lattice constant (reciprocal space)"</span>
<span class="linenos"> 70</span>     <span class="n">g_be</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">90.0</span>
<span class="linenos"> 71</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"beta  lattice angle (real space)"</span>
<span class="linenos"> 72</span>     <span class="n">g_be_s</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">90.0</span>
<span class="linenos"> 73</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"beta  lattice angle (reciprocal space)"</span>
<span class="linenos"> 74</span>     <span class="n">g_cc</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">5.139</span>
<span class="linenos"> 75</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"c lattice constant (real space)"</span>
<span class="linenos"> 76</span>     <span class="n">g_cc_s</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">1.222647462</span>
<span class="linenos"> 77</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"c lattice constant (reciprocal space)"</span>
<span class="linenos"> 78</span>     <span class="n">g_frz</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="linenos"> 79</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"freeze"</span>
<span class="linenos"> 80</span>     <span class="n">g_ga</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">90.0</span>
<span class="linenos"> 81</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"gamma lattice angle (real space)"</span>
<span class="linenos"> 82</span>     <span class="n">g_ga_s</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">90.0</span>
<span class="linenos"> 83</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"gamma lattice angle (reciprocal space)"</span>
<span class="linenos"> 84</span>     <span class="n">g_h0</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="linenos"> 85</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"H of primary reflection"</span>
<span class="linenos"> 86</span>     <span class="n">g_h1</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos"> 87</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"H of secondary reflection"</span>
<span class="linenos"> 88</span>     <span class="n">g_haz</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos"> 89</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"h azimuthal reference"</span>
<span class="linenos"> 90</span>     <span class="n">g_inci_offset</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos"> 91</span>     <span class="n">g_k0</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="linenos"> 92</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"K of primary reflection"</span>
<span class="linenos"> 93</span>     <span class="n">g_k1</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos"> 94</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"K of secondary reflection"</span>
<span class="linenos"> 95</span>     <span class="n">g_kappa</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">50.0</span>
<span class="linenos"> 96</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"angle of kappa tilt (in degrees)"</span>
<span class="linenos"> 97</span>     <span class="n">g_kaz</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos"> 98</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"k azimuthal reference"</span>
<span class="linenos"> 99</span>     <span class="n">g_l0</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos">100</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"L of primary reflection"</span>
<span class="linenos">101</span>     <span class="n">g_l1</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="linenos">102</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"L of secondary reflection"</span>
<span class="linenos">103</span>     <span class="n">g_lambda0</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.8265814273</span>
<span class="linenos">104</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"lambda when or0 was set"</span>
<span class="linenos">105</span>     <span class="n">g_lambda1</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.8265814273</span>
<span class="linenos">106</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"lambda when or1 was set"</span>
<span class="linenos">107</span>     <span class="n">g_laz</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="linenos">108</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"l azimuthal reference"</span>
<span class="linenos">109</span>     <span class="n">g_mode</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos">110</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"spectrometer mode"</span>
<span class="linenos">111</span>     <span class="n">g_mode_name</span><span class="p">:</span><span class="n">NX_CHAR</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">'Omega equals zero'</span><span class="p">]</span>
<span class="linenos">112</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"name of spectrometer mode"</span>
<span class="linenos">113</span>     <span class="n">g_mon_d</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">3.13542</span>
<span class="linenos">114</span>     <span class="n">g_mon_sam_len</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">68.0</span>
<span class="linenos">115</span>     <span class="n">g_mon_sign</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>
<span class="linenos">116</span>     <span class="n">g_omsect</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos">117</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"omega-mode sector flag"</span>
<span class="linenos">118</span>     <span class="n">g_picker</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="linenos">119</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"picker-mode factor"</span>
<span class="linenos">120</span>     <span class="n">g_sam_ana_len</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">68.0</span>
<span class="linenos">121</span>     <span class="n">g_sam_sign</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="linenos">122</span>     <span class="n">g_sect</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos">123</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"sector"</span>
<span class="linenos">124</span>     <span class="n">g_u00</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">60.0</span>
<span class="linenos">125</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"angle 0 of primary reflection"</span>
<span class="linenos">126</span>     <span class="n">g_u01</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">30.0</span>
<span class="linenos">127</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"angle 1 of primary reflection"</span>
<span class="linenos">128</span>     <span class="n">g_u02</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">90.0</span>
<span class="linenos">129</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"angle 2 of primary reflection"</span>
<span class="linenos">130</span>     <span class="n">g_u03</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos">131</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"angle 3 of primary reflection"</span>
<span class="linenos">132</span>     <span class="n">g_u04</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos">133</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"angle 4 of primary reflection"</span>
<span class="linenos">134</span>     <span class="n">g_u05</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos">135</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"angle 5 of primary reflection"</span>
<span class="linenos">136</span>     <span class="n">g_u10</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">60.0</span>
<span class="linenos">137</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"angle 0 of secondary reflection"</span>
<span class="linenos">138</span>     <span class="n">g_u11</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">30.0</span>
<span class="linenos">139</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"angle 1 of secondary reflection"</span>
<span class="linenos">140</span>     <span class="n">g_u12</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos">141</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"angle 2 of secondary reflection"</span>
<span class="linenos">142</span>     <span class="n">g_u13</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos">143</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"angle 3 of secondary reflection"</span>
<span class="linenos">144</span>     <span class="n">g_u14</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos">145</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"angle 4 of secondary reflection"</span>
<span class="linenos">146</span>     <span class="n">g_u15</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos">147</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"angle 5 of secondary reflection"</span>
<span class="linenos">148</span>     <span class="n">g_vmode</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos">149</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"set if vertical mode"</span>
<span class="linenos">150</span>     <span class="n">g_xtalogic_d1</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">463.6</span>
<span class="linenos">151</span>     <span class="n">g_xtalogic_d2</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">838.8</span>
<span class="linenos">152</span>     <span class="n">g_zh0</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos">153</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"h zone vec 0"</span>
<span class="linenos">154</span>     <span class="n">g_zh1</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos">155</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"h zone vec 1"</span>
<span class="linenos">156</span>     <span class="n">g_zk0</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos">157</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"k zone vec 0"</span>
<span class="linenos">158</span>     <span class="n">g_zk1</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos">159</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"k zone vec 1"</span>
<span class="linenos">160</span>     <span class="n">g_zl0</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos">161</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"l zone vec 0"</span>
<span class="linenos">162</span>     <span class="n">g_zl1</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos">163</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"l zone vec 1"</span>
<span class="linenos">164</span>     <span class="n">ub_matrix</span><span class="p">:</span><span class="n">NX_FLOAT64</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">__array</span>
<span class="linenos">165</span>       <span class="n">__array</span> <span class="o">=</span> <span class="p">[</span>
<span class="linenos">166</span>           <span class="p">[</span><span class="o">-</span><span class="mf">7.940607166e-18</span><span class="p">,</span> <span class="mf">1.138130079e-16</span><span class="p">,</span> <span class="mf">1.222647462</span><span class="p">]</span>
<span class="linenos">167</span>           <span class="p">[</span><span class="mf">0.8645423114</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8645423114</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
<span class="linenos">168</span>           <span class="p">[</span><span class="mf">0.8645423114</span><span class="p">,</span> <span class="mf">0.8645423114</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.668317968e-16</span><span class="p">]</span>
<span class="linenos">169</span>         <span class="p">]</span>
<span class="linenos">170</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"UB[] matrix"</span>
<span class="linenos">171</span>   <span class="n">monochromator</span><span class="p">:</span><span class="n">NXmonochromator</span>
<span class="linenos">172</span>     <span class="nd">@NX_class</span> <span class="o">=</span> <span class="s2">"NXmonochromator"</span>
<span class="linenos">173</span>     <span class="n">wavelength</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.8265814273</span>
<span class="linenos">174</span>       <span class="nd">@target</span> <span class="o">=</span> <span class="s2">"/S1/instrument/monochromator/wavelength"</span>
<span class="linenos">175</span>       <span class="nd">@units</span> <span class="o">=</span> <span class="s2">"angstrom"</span>
</pre></div>
</div>
<p>Crystal sample orientation information (<code class="docutils literal notranslate"><span class="pre">UB</span></code> matrix, orientation reflections
and wavelength) is written to a <strong>NXsample</strong> <a class="footnote-reference brackets" href="#nxsample" id="id25">22</a> group named <code class="docutils literal notranslate"><span class="pre">sample</span></code>
as a child of the scan group.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="n">sample</span><span class="p">:</span><span class="n">NXsample</span>
<span class="linenos"> 2</span>   <span class="nd">@NX_class</span> <span class="o">=</span> <span class="s2">"NXsample"</span>
<span class="linenos"> 3</span>   <span class="n">diffractometer_mode</span><span class="p">:</span><span class="n">NX_CHAR</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">'Omega equals zero'</span><span class="p">]</span>
<span class="linenos"> 4</span>   <span class="n">diffractometer_sector</span><span class="p">:</span><span class="n">NX_INT64</span> <span class="o">=</span> <span class="mi">0</span>
<span class="linenos"> 5</span>   <span class="n">ub_matrix</span><span class="p">:</span><span class="n">NX_FLOAT64</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">__array</span>
<span class="linenos"> 6</span>     <span class="n">__array</span> <span class="o">=</span> <span class="p">[</span>
<span class="linenos"> 7</span>         <span class="p">[</span><span class="o">-</span><span class="mf">7.940607166e-18</span><span class="p">,</span> <span class="mf">1.138130079e-16</span><span class="p">,</span> <span class="mf">1.222647462</span><span class="p">]</span>
<span class="linenos"> 8</span>         <span class="p">[</span><span class="mf">0.8645423114</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8645423114</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
<span class="linenos"> 9</span>         <span class="p">[</span><span class="mf">0.8645423114</span><span class="p">,</span> <span class="mf">0.8645423114</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.668317968e-16</span><span class="p">]</span>
<span class="linenos">10</span>       <span class="p">]</span>
<span class="linenos">11</span>   <span class="n">unit_cell</span><span class="p">:</span><span class="n">NX_FLOAT64</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5.139</span><span class="p">,</span> <span class="mf">5.139</span><span class="p">,</span> <span class="mf">5.139</span><span class="p">,</span> <span class="s1">'...'</span><span class="p">,</span> <span class="mf">90.0</span><span class="p">]</span>
<span class="linenos">12</span>   <span class="n">unit_cell_abc</span><span class="p">:</span><span class="n">NX_FLOAT64</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5.139</span><span class="p">,</span> <span class="mf">5.139</span><span class="p">,</span> <span class="mf">5.139</span><span class="p">]</span>
<span class="linenos">13</span>     <span class="nd">@units</span> <span class="o">=</span> <span class="s2">"angstrom"</span>
<span class="linenos">14</span>   <span class="n">unit_cell_alphabetagamma</span><span class="p">:</span><span class="n">NX_FLOAT64</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">90.0</span><span class="p">,</span> <span class="mf">90.0</span><span class="p">,</span> <span class="mf">90.0</span><span class="p">]</span>
<span class="linenos">15</span>     <span class="nd">@units</span> <span class="o">=</span> <span class="s2">"degrees"</span>
<span class="linenos">16</span>   <span class="n">beam</span><span class="p">:</span><span class="n">NXbeam</span>
<span class="linenos">17</span>     <span class="nd">@NX_class</span> <span class="o">=</span> <span class="s2">"NXbeam"</span>
<span class="linenos">18</span>     <span class="n">incident_wavelength</span> <span class="o">--&gt;</span> <span class="o">/</span><span class="n">S1</span><span class="o">/</span><span class="n">instrument</span><span class="o">/</span><span class="n">monochromator</span><span class="o">/</span><span class="n">wavelength</span>
<span class="linenos">19</span>   <span class="n">or0</span><span class="p">:</span><span class="n">NXnote</span>
<span class="linenos">20</span>     <span class="nd">@NX_class</span> <span class="o">=</span> <span class="s2">"NXnote"</span>
<span class="linenos">21</span>     <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"or0: orientation reflection"</span>
<span class="linenos">22</span>     <span class="n">chi</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">90.0</span>
<span class="linenos">23</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"diffractometer angle"</span>
<span class="linenos">24</span>       <span class="nd">@units</span> <span class="o">=</span> <span class="s2">"degrees"</span>
<span class="linenos">25</span>     <span class="n">h</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="linenos">26</span>     <span class="n">k</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="linenos">27</span>     <span class="n">l</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos">28</span>     <span class="n">phi</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos">29</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"diffractometer angle"</span>
<span class="linenos">30</span>       <span class="nd">@units</span> <span class="o">=</span> <span class="s2">"degrees"</span>
<span class="linenos">31</span>     <span class="n">th</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">30.0</span>
<span class="linenos">32</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"diffractometer angle"</span>
<span class="linenos">33</span>       <span class="nd">@units</span> <span class="o">=</span> <span class="s2">"degrees"</span>
<span class="linenos">34</span>     <span class="n">tth</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">60.0</span>
<span class="linenos">35</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"diffractometer angle"</span>
<span class="linenos">36</span>       <span class="nd">@units</span> <span class="o">=</span> <span class="s2">"degrees"</span>
<span class="linenos">37</span>     <span class="n">wavelength</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.8265814273</span>
<span class="linenos">38</span>       <span class="nd">@units</span> <span class="o">=</span> <span class="s2">"Angstrom"</span>
<span class="linenos">39</span>   <span class="n">or1</span><span class="p">:</span><span class="n">NXnote</span>
<span class="linenos">40</span>     <span class="nd">@NX_class</span> <span class="o">=</span> <span class="s2">"NXnote"</span>
<span class="linenos">41</span>     <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"or1: orientation reflection"</span>
<span class="linenos">42</span>     <span class="n">chi</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos">43</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"diffractometer angle"</span>
<span class="linenos">44</span>       <span class="nd">@units</span> <span class="o">=</span> <span class="s2">"degrees"</span>
<span class="linenos">45</span>     <span class="n">h</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos">46</span>     <span class="n">k</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos">47</span>     <span class="n">l</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="linenos">48</span>     <span class="n">phi</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos">49</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"diffractometer angle"</span>
<span class="linenos">50</span>       <span class="nd">@units</span> <span class="o">=</span> <span class="s2">"degrees"</span>
<span class="linenos">51</span>     <span class="n">th</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">30.0</span>
<span class="linenos">52</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"diffractometer angle"</span>
<span class="linenos">53</span>       <span class="nd">@units</span> <span class="o">=</span> <span class="s2">"degrees"</span>
<span class="linenos">54</span>     <span class="n">tth</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">60.0</span>
<span class="linenos">55</span>       <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"diffractometer angle"</span>
<span class="linenos">56</span>       <span class="nd">@units</span> <span class="o">=</span> <span class="s2">"degrees"</span>
<span class="linenos">57</span>     <span class="n">wavelength</span><span class="p">:</span><span class="n">NX_FLOAT64</span> <span class="o">=</span> <span class="mf">0.8265814273</span>
<span class="linenos">58</span>       <span class="nd">@units</span> <span class="o">=</span> <span class="s2">"Angstrom"</span>
</pre></div>
</div>
</section>
<section id="instrument">
<span id="data-file-instrument"></span><h3>Instrument<a class="headerlink" href="#instrument" title="Permalink to this headline">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">/SCAN/instrument</span></code> group <a class="footnote-reference brackets" href="#nxinstrument" id="id26">16</a> is a NeXus base class
that provides a standardized way to describe the scientific instrument.
It has provisions to describe detectors, positioners, slits, monochromators,
and many other items used.</p>
<p>In the sample shown here, the <code class="docutils literal notranslate"><span class="pre">/SCAN/instrument/positioners</span></code> group is
linked to the content in <code class="docutils literal notranslate"><span class="pre">/SCAN/positioners</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">instrument</span><span class="p">:</span><span class="n">NXinstrument</span>
<span class="linenos">2</span>  <span class="nd">@NX_class</span> <span class="o">=</span> <span class="s2">"NXinstrument"</span>
<span class="linenos">3</span>  <span class="n">positioners</span> <span class="o">--&gt;</span> <span class="o">/</span><span class="n">S1</span><span class="o">/</span><span class="n">positioners</span>
</pre></div>
</div>
</section>
<section id="comments">
<span id="data-file-comments"></span><h3>Comments<a class="headerlink" href="#comments" title="Permalink to this headline">#</a></h3>
<p>These comments from an example SPEC data file scan:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1">#C Fri Mar 11 16:29:51 2022.  plan_type = generator</span>
<span class="linenos">2</span><span class="c1">#C Fri Mar 11 16:29:51 2022.  uid = dccc572d-9a5b-4f72-87d7-233b2fd33e4e</span>
<span class="linenos">3</span><span class="c1">#C Fri Mar 11 16:29:57 2022.  num_events_baseline = 2</span>
<span class="linenos">4</span><span class="c1">#C Fri Mar 11 16:29:57 2022.  num_events_primary = 10</span>
<span class="linenos">5</span><span class="c1">#C Fri Mar 11 16:29:57 2022.  exit_status = success</span>
</pre></div>
</div>
<p>are written to the <a class="reference internal" href="#data-file-scan"><span class="std std-ref">Scan</span></a> entry as a single NeXus <em>field</em>
<a class="footnote-reference brackets" href="#nx-field" id="id27">11</a> named <code class="docutils literal notranslate"><span class="pre">comments</span></code> where all the scan’s comments are joined together
by newline (<code class="docutils literal notranslate"><span class="pre">\n</span></code>) characters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">comments</span><span class="p">:</span><span class="n">NX_CHAR</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">'Fri Mar 11 16:29:51 2022.  plan_type = generator</span><span class="se">\n</span><span class="s1">Fri Mar 11 16:29:51 2022.  uid = dccc572d-9a5b-4f72-87d7-233b2fd33e4e</span><span class="se">\n</span><span class="s1">Fri Mar 11 16:29:57 2022.  num_events_baseline = 2</span><span class="se">\n</span><span class="s1">Fri Mar 11 16:29:57 2022.  num_events_primary = 10</span><span class="se">\n</span><span class="s1">Fri Mar 11 16:29:57 2022.  exit_status = success'</span><span class="p">]</span>
</pre></div>
</div>
<p>Note, when printed, the value of this example <code class="docutils literal notranslate"><span class="pre">comments</span></code> field looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Fri</span> <span class="n">Mar</span> <span class="mi">11</span> <span class="mi">16</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">51</span> <span class="mf">2022.</span>  <span class="n">plan_type</span> <span class="o">=</span> <span class="n">generator</span>
<span class="n">Fri</span> <span class="n">Mar</span> <span class="mi">11</span> <span class="mi">16</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">51</span> <span class="mf">2022.</span>  <span class="n">uid</span> <span class="o">=</span> <span class="n">dccc572d</span><span class="o">-</span><span class="mi">9</span><span class="n">a5b</span><span class="o">-</span><span class="mi">4</span><span class="n">f72</span><span class="o">-</span><span class="mi">87</span><span class="n">d7</span><span class="o">-</span><span class="mi">233</span><span class="n">b2fd33e4e</span>
<span class="n">Fri</span> <span class="n">Mar</span> <span class="mi">11</span> <span class="mi">16</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">57</span> <span class="mf">2022.</span>  <span class="n">num_events_baseline</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">Fri</span> <span class="n">Mar</span> <span class="mi">11</span> <span class="mi">16</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">57</span> <span class="mf">2022.</span>  <span class="n">num_events_primary</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">Fri</span> <span class="n">Mar</span> <span class="mi">11</span> <span class="mi">16</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">57</span> <span class="mf">2022.</span>  <span class="n">exit_status</span> <span class="o">=</span> <span class="n">success</span>
</pre></div>
</div>
</section>
<section id="metadata">
<span id="data-file-metadata"></span><h3>Metadata<a class="headerlink" href="#metadata" title="Permalink to this headline">#</a></h3>
<p>TODO:  #U and other (#H/#V, #UXML, …)</p>
</section>
<section id="unrecognized-control-line">
<span id="data-file-unrecognized"></span><h3>Unrecognized Control Line<a class="headerlink" href="#unrecognized-control-line" title="Permalink to this headline">#</a></h3>
<p>Any control line that is not recognized by a plugin (see <a class="reference internal" href="spec.html#plugin-list"><span class="std std-ref">Control lines (keys) defined by SPEC</span></a>)
will be written to a <strong>NXnote</strong> <a class="footnote-reference brackets" href="#nxnote" id="id28">19</a> group named <code class="docutils literal notranslate"><span class="pre">unrecognized_{N}</span></code>
(where <code class="docutils literal notranslate"><span class="pre">{N}</span></code>) is a numbered index starting at <code class="docutils literal notranslate"><span class="pre">1</span></code>. (The algorithm looks for
the first available name not already used.)  Each unrecognized control line will
be added to this group in a separate field. Here is an example from a SPEC data
file with two such lines:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1"># this line will not be recognized</span>
<span class="linenos">2</span>
<span class="linenos">3</span><span class="c1"># another one</span>
</pre></div>
</div>
<p>and how that content is represented in the NeXus HDF5 file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">unrecognized_1</span><span class="p">:</span><span class="n">NXnote</span>
<span class="linenos">2</span>   <span class="nd">@NX_class</span> <span class="o">=</span> <span class="s2">"NXnote"</span>
<span class="linenos">3</span>   <span class="nd">@description</span> <span class="o">=</span> <span class="s2">"SPEC data file control lines not otherwise recognized"</span>
<span class="linenos">4</span>   <span class="n">u0</span><span class="p">:</span><span class="n">NX_CHAR</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">'# this line will not be recognized'</span><span class="p">]</span>
<span class="linenos">5</span>     <span class="nd">@spec_name</span> <span class="o">=</span> <span class="s2">"u0"</span>
<span class="linenos">6</span>   <span class="n">u1</span><span class="p">:</span><span class="n">NX_CHAR</span> <span class="o">=</span> <span class="p">[</span><span class="sa">b</span><span class="s1">'# another one'</span><span class="p">]</span>
<span class="linenos">7</span>     <span class="nd">@spec_name</span> <span class="o">=</span> <span class="s2">"u1"</span>
</pre></div>
</div>
</section>
</section>
<section id="footnotes">
<h2>Footnotes<a class="headerlink" href="#footnotes" title="Permalink to this headline">#</a></h2>
<dl class="footnote brackets">
<dt class="label" id="spec-format"><span class="brackets">1</span><span class="fn-backref">(<a href="#id2">1</a>,<a href="#id11">2</a>)</span></dt>
<dd><p>SPEC <strong>Standard Data-File Format</strong> :
<a class="reference external" href="https://certif.com/spec_manual/mac_3_13.html">https://certif.com/spec_manual/mac_3_13.html</a></p>
</dd>
<dt class="label" id="punx"><span class="brackets"><a class="fn-backref" href="#id1">2</a></span></dt>
<dd><p>Visualize NeXus file tree structure :
<a class="reference external" href="https://prjemian.github.io/punx/tree.html#tree">https://prjemian.github.io/punx/tree.html#tree</a></p>
</dd>
<dt class="label" id="id29"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p>NeXus objects and terms:
<a class="reference external" href="https://manual.nexusformat.org/design.html#nexus-objects-and-terms">https://manual.nexusformat.org/design.html#nexus-objects-and-terms</a></p>
</dd>
<dt class="label" id="id30"><span class="brackets"><a class="fn-backref" href="#id4">4</a></span></dt>
<dd><p>NeXus tree structure:
<a class="reference external" href="https://manual.nexusformat.org/introduction.html#example-of-a-nexus-file">https://manual.nexusformat.org/introduction.html#example-of-a-nexus-file</a></p>
</dd>
<dt class="label" id="id31"><span class="brackets"><a class="fn-backref" href="#id5">5</a></span></dt>
<dd><p>NeXus groups (base classes):
<a class="reference external" href="https://manual.nexusformat.org/classes/base_classes/">https://manual.nexusformat.org/classes/base_classes/</a></p>
</dd>
<dt class="label" id="control-line"><span class="brackets"><a class="fn-backref" href="#id12">6</a></span></dt>
<dd><p>See <a class="reference internal" href="plugin_core.html#supplied-plugins"><span class="std std-ref">Supplied spec plugin modules</span></a> for a full list of the supported
control lines provided with <strong>spec2nexus</strong>.</p>
</dd>
<dt class="label" id="nx-datatype"><span class="brackets"><a class="fn-backref" href="#id7">7</a></span></dt>
<dd><p>List of NeXus data types:
<a class="reference external" href="https://manual.nexusformat.org/nxdl-types.html#field-types-allowed-in-nxdl-specifications">https://manual.nexusformat.org/nxdl-types.html#field-types-allowed-in-nxdl-specifications</a></p>
</dd>
<dt class="label" id="nx-units-datarules"><span class="brackets"><a class="fn-backref" href="#id21">8</a></span></dt>
<dd><p><a class="reference external" href="https://manual.nexusformat.org/datarules.html#design-units">https://manual.nexusformat.org/datarules.html#design-units</a></p>
</dd>
<dt class="label" id="nx-naming-datarules"><span class="brackets">9</span></dt>
<dd><p><a class="reference external" href="https://manual.nexusformat.org/datarules.html#naming-conventions">https://manual.nexusformat.org/datarules.html#naming-conventions</a></p>
</dd>
<dt class="label" id="nx-unittype"><span class="brackets">10</span><span class="fn-backref">(<a href="#id8">1</a>,<a href="#id20">2</a>)</span></dt>
<dd><p>List of NeXus unit categories:
<a class="reference external" href="https://manual.nexusformat.org/nxdl-types.html#unit-categories-allowed-in-nxdl-specifications">https://manual.nexusformat.org/nxdl-types.html#unit-categories-allowed-in-nxdl-specifications</a></p>
</dd>
<dt class="label" id="nx-field"><span class="brackets">11</span><span class="fn-backref">(<a href="#id6">1</a>,<a href="#id27">2</a>)</span></dt>
<dd><p>A NeXus <strong>field</strong> is the same as an HDF5 <strong>dataset</strong>.  The rename is
due to historical reasons in NeXus when XML was used as a back-end data file
storage format.</p>
</dd>
<dt class="label" id="nx-default"><span class="brackets"><a class="fn-backref" href="#id10">12</a></span></dt>
<dd><p>Used to identify the default plottable data in a NeXus HDF5 file.
<a class="reference external" href="https://manual.nexusformat.org/datarules.html#version-3">https://manual.nexusformat.org/datarules.html#version-3</a></p>
</dd>
</dl>
<p>NeXus base classes</p>
<dl class="footnote brackets">
<dt class="label" id="nxdata"><span class="brackets">13</span><span class="fn-backref">(<a href="#id14">1</a>,<a href="#id16">2</a>)</span></dt>
<dd><p><strong>NXdata</strong>:   <a class="reference external" href="https://manual.nexusformat.org/classes/base_classes/NXdata.html">https://manual.nexusformat.org/classes/base_classes/NXdata.html</a></p>
</dd>
<dt class="label" id="nxdetector"><span class="brackets">14</span></dt>
<dd><p><strong>NXdetector</strong>:   <a class="reference external" href="https://manual.nexusformat.org/classes/base_classes/NXdetector.html">https://manual.nexusformat.org/classes/base_classes/NXdetector.html</a></p>
</dd>
<dt class="label" id="nxentry"><span class="brackets"><a class="fn-backref" href="#id13">15</a></span></dt>
<dd><p><strong>NXentry</strong>:   <a class="reference external" href="https://manual.nexusformat.org/classes/base_classes/NXentry.html">https://manual.nexusformat.org/classes/base_classes/NXentry.html</a></p>
</dd>
<dt class="label" id="nxinstrument"><span class="brackets">16</span><span class="fn-backref">(<a href="#id18">1</a>,<a href="#id26">2</a>)</span></dt>
<dd><p><strong>NXinstrument</strong>:   <a class="reference external" href="https://manual.nexusformat.org/classes/base_classes/NXinstrument.html">https://manual.nexusformat.org/classes/base_classes/NXinstrument.html</a></p>
</dd>
<dt class="label" id="nxmonitor"><span class="brackets"><a class="fn-backref" href="#id15">17</a></span></dt>
<dd><p><strong>NXmonitor</strong>: <a class="reference external" href="https://manual.nexusformat.org/classes/base_classes/NXmonitor.html">https://manual.nexusformat.org/classes/base_classes/NXmonitor.html</a></p>
</dd>
<dt class="label" id="nxmonochromator"><span class="brackets">18</span></dt>
<dd><p><strong>NXmonochromator</strong>:   <a class="reference external" href="https://manual.nexusformat.org/classes/base_classes/NXmonochromator.html">https://manual.nexusformat.org/classes/base_classes/NXmonochromator.html</a></p>
</dd>
<dt class="label" id="nxnote"><span class="brackets">19</span><span class="fn-backref">(<a href="#id17">1</a>,<a href="#id22">2</a>,<a href="#id23">3</a>,<a href="#id24">4</a>,<a href="#id28">5</a>)</span></dt>
<dd><p><strong>NXnote</strong>:   <a class="reference external" href="https://manual.nexusformat.org/classes/base_classes/NXnote.html">https://manual.nexusformat.org/classes/base_classes/NXnote.html</a></p>
</dd>
<dt class="label" id="nxpositioner"><span class="brackets"><a class="fn-backref" href="#id19">20</a></span></dt>
<dd><p><strong>NXpositioner</strong>:   <a class="reference external" href="https://manual.nexusformat.org/classes/base_classes/NXpositioner.html">https://manual.nexusformat.org/classes/base_classes/NXpositioner.html</a></p>
</dd>
<dt class="label" id="nxroot"><span class="brackets"><a class="fn-backref" href="#id9">21</a></span></dt>
<dd><p><strong>NXroot</strong>:   <a class="reference external" href="https://manual.nexusformat.org/classes/base_classes/NXroot.html">https://manual.nexusformat.org/classes/base_classes/NXroot.html</a></p>
</dd>
<dt class="label" id="nxsample"><span class="brackets"><a class="fn-backref" href="#id25">22</a></span></dt>
<dd><p><strong>NXsample</strong>:   <a class="reference external" href="https://manual.nexusformat.org/classes/base_classes/NXsample.html">https://manual.nexusformat.org/classes/base_classes/NXsample.html</a></p>
</dd>
</dl>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="specplot.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">specplot</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="extractSpecScan.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">extractSpecScan</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2014-2022, Pete R. Jemian
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">NeXus File Layout</a><ul>
<li><a class="reference internal" href="#basic-tree-structure">Basic Tree Structure</a><ul>
<li><a class="reference internal" href="#example-1-d-scan">Example 1-D scan</a></li>
</ul>
</li>
<li><a class="reference internal" href="#spec-data-file-contents">SPEC Data File Contents</a><ul>
<li><a class="reference internal" href="#file-name">File name</a></li>
<li><a class="reference internal" href="#file-header">File header</a></li>
<li><a class="reference internal" href="#scan">Scan</a></li>
<li><a class="reference internal" href="#scan-data">Scan Data</a></li>
<li><a class="reference internal" href="#positioners">Positioners</a></li>
<li><a class="reference internal" href="#counters">Counters</a></li>
<li><a class="reference internal" href="#geometry">Geometry</a></li>
<li><a class="reference internal" href="#instrument">Instrument</a></li>
<li><a class="reference internal" href="#comments">Comments</a></li>
<li><a class="reference internal" href="#metadata">Metadata</a></li>
<li><a class="reference internal" href="#unrecognized-control-line">Unrecognized Control Line</a></li>
</ul>
</li>
<li><a class="reference internal" href="#footnotes">Footnotes</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/furo.js"></script>
    </body>
</html>